Function MapDrive($DriveLetter, $UNC, optional $Label, optional $Icon, optional $Delete, optional $verbose)	dim $subcmd, $pt, $d, $di, $shell, $text	$d = left($DriveLetter,1) 	$di= "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\DriveIcons"	$pt= @producttype	$subcmd = iif($pt = "Windows NT Workstation","subst","net use")	$text = iif($label,$label,' ')	if $delete		shell '%comspec% /c $subcmd $d: /d /y 1>Nul 2>&1'		$nul=deltree("$di\$D")	endif	if not exist('$D:\')		shell '%comspec% /c $subcmd $D: "$UNC" 1>Nul 2>&1'		if $verbose			if not @error				Show('   Connected '+ ucase($driveletter)+ ': to '+ $UNC + '  ( '+ $text + ' )')				sleep 1			else				Show('   FAILED ' + ucase($driveletter)+': Connected to '+ $UNC+ '  ( '+ $text + ' )')				exit 1			endif		endif	else		exit 2	endif	;if $pt="Windows XP Professional" or $pt="Windows 2000 Professional"		if $Label			$shell=createobject("shell.application")			$shell.namespace('$D:\').self.name=$Label		endif		if $icon		 	$=writevalue('$di\$D\DefaultIcon','',$Icon,REG_SZ)		endif	;endifENDFUNCTION